function Pirates(){"use strict";function v(e,t,n){this.x=e,this.y=t,this.t=n}function m(){this.data=new Array,this.timer=null,this.init=function(t,n){for(var r=0;r<10;r++)this.data.push(new v(t,n,(new Date).getTime()))},this.update=function(t,n){for(var r=9;r>0;r--)this.data[r]=this.data[r-1];this.data[0]=new v(t,n,(new Date).getTime())},this.dx=function(t){var n=t-this.data[0].t;return n>100?0:this.data[0].x-this.data[9].x},this.dy=function(t){var n=t-this.data[0].t;return n>100?0:this.data[0].y-this.data[9].y}}function g(e,n,o){$(e).addClass("flying");var u=parseInt($(e).css("left")),a=parseInt($(e).css("top")),f=0,l=u,c=a,h=-81,p=1024,d=460,v=setInterval(function(){var u=l+n/10;if(u<h||u>p)n*=-1;l+=n/10,c=a+o/10*f+f*f,f++;var m=s.boatidx[s.currboat];if(l>=560&&c>=398&&m<10&&s.input){l>p-81&&(l=p-81),l-=560,$(e).hasClass("redpirate1")?c=398:$(e).hasClass("greenpirate1")?c=402:$(e).hasClass("bluepirate1")&&(c=406),c-=93,clearInterval(v),$(e).removeClass("flying");var g="#pirates_slot"+(m+1);s.boatidx[s.currboat]++;var y=10-m-1;$(g).addClass("green"),y>1?($("#pirates_msg2").html(t),$("#pirates_msg2 b").html(y.toLocaleString())):$("#pirates_msg2").html(r);var w=$("#pirates_stranded "+e)[0];$("#pirates_stranded "+e).remove(),$("#pirates_saved").append(w),$(e).css({top:c,left:l}),$(e).removeClass("stranded"),$(e).addClass("saved"),i.goodnoise.play(),m==9&&(b(),s.input=!1)}else l>=h&&c<d?(l>p&&(l=p),$(e).css({top:c,left:l})):(c<0&&(c=0),l<0&&(l=0),c>d&&(c=d),l>560&&(l=500),$(e).css({top:c,left:l}),$(e).removeClass("flying"),clearInterval(v),i.badnoise.play())},20)}function y(){this.input=!1,this.boat=new Array,this.currboat=0,this.boatidx=new Array,this.total=0,this.pos=[[461,474],[457,387],[450,295],[448,201],[459,115],[472,19],[452,429],[449,343],[441,249],[439,155],[459,66],[473,516],[458,491],[450,459],[439,407],[432,365],[434,325],[434,275],[435,219],[443,180],[452,136],[449,91],[482,47],[475,431],[465,359],[472,285],[470,212],[471,124],[484,484],[482,398],[478,323],[486,256],[485,166],[480,84],[485,0],[482,536],[481,441],[489,291],[487,128],[481,207]];var e=new Array,t;for(t=1;t<=10;t++)e.push(t);for(t=0;t<4;t++){var n=Math.random()*e.length|0,r=parseInt(e.splice(n,1));this.boat[t]=r,this.boatidx[t]=10-r,this.total+=r}}function b(){$("#pirates_msg2").removeClass("show"),$("#pirates_ship").removeClass("slide"),s.currboat++,s.currboat<4?($("#pirates_msg3").addClass("show"),o=setTimeout(function(){w()},6e3)):($("#pirates_msg4").addClass("show"),o=setTimeout(function(){E()},4e3)),i.pirate_shipslide.play()}function w(){$("#pirates_saved").empty();var t=s.currboat;for(var r=0;r<10;r++){var u="#pirates_slot"+(r+1);$(u).removeClass("green"),$(u).removeClass("red"),r<s.boatidx[t]?$(u).addClass("red"):$(u).removeClass("red")}s.boat[t]>1?($("#pirates_msg2").html(e),$("#pirates_msg2 b").html(s.boat[t].toLocaleString())):$("#pirates_msg2").html(n),$("#pirates_msg1").removeClass("show"),$("#pirates_ship").addClass("slide"),$("#pirates_msg2").addClass("show"),$("#pirates_msg3").removeClass("show"),$("#pirates_msg4").removeClass("show"),o=setTimeout(function(){s.input=!0},4e3),i.pirate_shipslide.play()}function E(){for(var e=0;e<40;e++){var t="#pirates_mslot"+(e+1),n=10-s.boat[e/10|0];$(t).removeClass("green"),$(t).removeClass("red"),e%10<n?$(t).addClass("red"):$(t).addClass("green")}$("#pirates_page").hide(),$("#pirates_win_page").show(),i.pirate_arr.play()}function S(){x(),i.pirate_bgloop.stop(),$("#pirates_page").hide(),$("#pirates_win_page").hide(),setTimeout(function(){$("#game_menu_border").hide(),$("#home_page").show()},0)}function x(){o&&clearTimeout(o),$("#pirates_msg1").removeClass("show"),$("#pirates_msg2").removeClass("show"),$("#pirates_msg3").removeClass("show"),$("#pirates_msg4").removeClass("show"),$("#pirates_stranded").empty(),$("#pirates_ship").removeClass("slide"),$("#pirates_saved").empty(),$("#pirates_win_page").hide()}function T(){$("#pirates_page").hide(),x(),s=new y,$("#pirates_msg1 b").html(s.total.toLocaleString()),$("#pirates_msg6 b").html(s.total.toLocaleString()),i.pirate_saveus.play(),i.pirate_bgloop.play(),$("#home_page").hide(),$("#game_menu_border").show(),$("#pirates_page").show();var e=["red","blue","green"];for(var t=0;t<s.total;t++){var n=e[t%3],r=s.pos[t][0],v=s.pos[t][1],g='<div id="pirate'+(t+1)+'" class="'+n+'pirate1 draggable_pirate stranded"'+' style="top: '+r+"px; left: "+v+'px;">'+'<div class="'+n+'piratelarm"></div>'+'<div class="'+n+'piraterarm"></div>'+'<div class="'+n+'piratebody"></div>'+"</div>";$("#pirates_stranded").append(g)}$("#pirates_msg1").addClass("show"),o=setTimeout(function(){w()},5e3),$("#pirates_page .draggable_pirate").mousedown(function(e){if(!s.input)return;var t="#"+e.currentTarget.id;if($(t).hasClass("flying"))return;i.pirate_arr.play(),u=new m,a=new WebKitCSSMatrix(window.getComputedStyle(document.body).webkitTransform),isrotated?u.init(e.clientY,0-e.clientX):u.init(e.clientX,e.clientY),f=t,l=e.currentTarget,c=e.clientX,h=e.clientY,p=parseInt(e.currentTarget.style.left+0),d=parseInt(e.currentTarget.style.top+0),$(f).css("z-index",10)})}function N(){var e="";$("#pirates_slots").empty();for(var t=1;t<=10;t++)e+='<div id="pirates_slot'+t+'" class="pirates_slot"></div>';$("#pirates_slots").html(e);for(var n=1;n<=4;n++){$("#pirates_grid"+n).empty(),e="";for(var t=1;t<=10;t++)e+='<div id="pirates_mslot'+(t+(n-1)*10)+'" class="pirates_mslot s'+t+'"></div>';$("#pirates_grid"+n).html(e)}}function C(){setTimeout(N,0),e="This ship can hold <b></b> pirates.<br>Drag the pirates to the ship.",t="This ship can hold <b></b> more pirates.<br>Drag the pirates to the ship.",n="This ship can hold <b>1</b> pirate.<br>Drag him to the ship.",r="This ship can hold <b>1</b> more pirate.<br>Drag him to the ship.",window.chrome&&window.chrome.i18n&&($("#pirates_msg1").html(chrome.i18n.getMessage("pirates_msg1")),$("#pirates_msg2").html(chrome.i18n.getMessage("pirates_msg2p")),e=chrome.i18n.getMessage("pirates_msg2pi"),n=chrome.i18n.getMessage("pirates_msg2si"),t=chrome.i18n.getMessage("pirates_msg2p"),r=chrome.i18n.getMessage("pirates_msg2s"),$("#pirates_msg3").html(chrome.i18n.getMessage("pirates_msg3")),$("#pirates_msg4").html(chrome.i18n.getMessage("pirates_msg4"))),i.pirate_arr=new GameSound("audio/Tenframe_Pirates_Vo_SaveAPirate.ogg",1),i.pirate_saveus=new GameSound("audio/Tenframe_Pirates_Vo_Intro.ogg",1),i.pirate_bgloop=new GameSound("audio.pirate_bgloop",0),i.pirate_shipslide=new GameSound("audio/shipslide.ogg",1),i.goodnoise=new GameSound("audio/Bowling_CorrectAnswer.ogg",1),i.badnoise=new GameSound("audio/Bowling_IncorrectAnswer.ogg",1),i.pirate_bgloop.volume(.3),$("#pirates_page").mousemove(function(e){if(s.input&&f)if(isrotated){var t=(e.clientY-h)/a.b+p,n=(e.clientX-c)/a.c+d;u.update(e.clientY,0-e.clientX),l.style.left=t+"px",l.style.top=n+"px"}else{var t=(e.clientX-c)/a.a+p,n=(e.clientY-h)/a.d+d;u.update(e.clientX,e.clientY),l.style.left=t+"px",l.style.top=n+"px"}}),$("#pirates_page").mouseup(function(e){if(f){var t=(new Date).getTime();g(f,u.dx(t),u.dy(t)),$(f).css("z-index",1)}f=undefined}),$("#pirates_win_page").click(function(){S()})}var e,t,n,r,i={},s,o,u,a,f,l,c,h,p,d;this.close=S,this.start=T,C()}